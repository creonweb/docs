# Стандарты написания кода при разработке сайтов на MODX Revolution
## Ссылки на документы:
> [мануал по использованию Fenom](https://habrahabr.ru/post/264635/) 

> [Руководство по использованию pdoTools](https://docs.modx.pro/components/pdotools/)

# Использование PDOTools и Fenom

Основными инструментами являются PDOTools и шаблонизатор Fenom.

Для создания меню, хлебных крошек, вывода ресурсов, создания карты сайта, вывода списка пользователей и так далее – должна использоваться библиотека PDOTools. С ее помощью можно решить большинство типовых задач. 

Все чанки и шаблоны должны быть описаны в синтаксисе шаблонизатора Fenom. Использование стандартного синтаксиса MODX допускается ТОЛЬКО ТОГДА, когда сниппет, под который написан чанк, не поддерживает PDOTools. Это относится, например, к Gallery и getImageList. 

Во всех остальных случаях использование стандартного синтаксиса **НЕДОПУСТИМО**. 

Все чанки, шаблоны, пользовательские сниппеты и плагины должны быть файлами, и не могут быть созданы через админку MODX (кроме тех, что должны быть зарегистрированы в системе). 

## Структура проекта

Все элементы хранятся в папке CORE_PATH. ‘elements/’ со следующей структурой (рис 1.)

![Риcунок 1](/img/pic1.png)
###### Рисунок 1. Расположение папок элементов.

Чанки хранятся в папке chunks и так же имеют свою структуру расположения (рис 2.)

![Риcунок 2](/img/pic2.png)
###### Рисунок 2. Структура расположения чанков

Все чанки создаются в IDE и имеют расширение **.tpl**.

Общие для всего сайта чанки (шапка, подвал, подключение стилей и скриптов, хлебные крошки) всегда хранятся в папке common.

Отдельные блоки сайта или отдельные функции хранятся в своих папках. Личный кабинет – office, поиск – search и так далее.

Все шаблоны форм хранятся в папке Forms. 

Вызовы форм так же желательно сохранять в отдельных чанках.

Все чанки, относящиеся к miniShop2 хранятся в папке Shop и так же разбиты по своим папкам.

В папке cart хранятся чанки-шаблоны вызовов msCart, msMiniCart, msOrder.

В папке category – вызов mFilter2 для создания раздела категории или же вызов другого сниппета, например, msProducts.

Папка filter, как правило, содержит в себе шаблоны категорий, а так же шаблоны внешнего вида отдельного вида фильтров. 

Папка product – содержит шаблоны, относящиеся непосредственно к товару:

* Чанк product.tpl заменяет чанк msProductContent
* Чанк product.row.tpl заменяет чанк tpl.msProducts.row
* Так же в этой папке могу содержаться шаблоны для вывода сниппетов, связанных с опциями товаров а так же с модификациями.  


## Именование чанков

В именовании чанков, шаблонов, сниппетов, плагинов запрещено использовать транслит. 

**Чанки вроде – kartochkaTovara.tpl не будут приняты!** 

Для более-менее корректного перевода можно воспользоваться Google-переводчиком.

При именовании элементов желательно использовать простые слова, которые максимально отражают суть элемента и его роль. 

Чанки, которые многократно используются на странице и выводят повторяющуюся информацию, именуются chunkname.row.tpl 

Наиболее правильным является именование по шаблону "используемый компонент.блок на сайте.что делает.tpl", примеры: 

* product.gallery.tpl - галерея товара
* product.tpl - главный чанк товара
* office.sidebar.login.tpl - чанк авторизации в сайдбаре
* office.sidebar.logout.tpl - чанк выхода в сайдбаре
* filter.checkbox.outer.tpl - чанк-обёртка для чекбокса в фильтре

## Нюансы шаблонов
Шаблонизатор Fenom поддерживает наследование шаблонов, подробнее об этом можно прочитать в документации к PDOTools. 
Смысл в том, что изначально используется базовый шаблон base.tpl, в котором уже описаны все блоки, которые потом расширяются. 
На рисунке изображены типичные шаблоны сайта, шаблон base.tpl – основной.

![Риcунок 3](/img/pic3.png)
###### Рисунок 3. Типичные шаблоны

### Типовая разметка базового шаблона
```php
<!doctype html>
<html>
    {block 'HEAD'}
        {include 'file:chunks/common/head.tpl'}
    {/block}
    <body>
        {block 'HEADER'}
            {include 'file:chunks/common/header.tpl'}
        {/block}
        {block 'BREADCRUMBS'}
            {*include 'file:chunks/common/breadcrumbs.tpl'*}
        {/block}        
        {block 'CONTENT'}
        {/block}
        {block 'FOOTER'}
            {include 'file:chunks/common/footer.tpl'}
        {/block}
        {block 'MODALS'}
            {include 'file:chunks/modals/modal.login.tpl'}
        {/block}
        {block 'SCRIPTS'}
            {*include 'file:chunks/common/scripts.tpl'*}
        {/block}
    </body>
</html>
```



